"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (this && this.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};
Object.defineProperty(exports, "__esModule", { value: true });
var order_model_1 = require("../models/order.model");
var InvoiceLogic = /** @class */ (function () {
    function InvoiceLogic() {
    }
    /**
     * create coupon
     */
    InvoiceLogic.prototype.getInvoiceHTML = function (_a) {
        var orderId = _a.orderId;
        return __awaiter(this, void 0, void 0, function () {
            var _this = this;
            return __generator(this, function (_b) {
                return [2 /*return*/, new Promise(function (resolve, reject) { return __awaiter(_this, void 0, void 0, function () {
                        var orderInfo, commonTemplet, error_1;
                        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4, _5, _6, _7, _8, _9, _10, _11, _12, _13, _14, _15, _16, _17, _18;
                        return __generator(this, function (_19) {
                            switch (_19.label) {
                                case 0:
                                    _19.trys.push([0, 2, , 3]);
                                    return [4 /*yield*/, order_model_1.OrderModel.findById(orderId).populate([
                                            {
                                                path: "user",
                                            },
                                            {
                                                path: "billing",
                                                populate: {
                                                    path: "orders",
                                                },
                                            },
                                            {
                                                path: "extraBilling",
                                            },
                                        ])];
                                case 1:
                                    orderInfo = _19.sent();
                                    if (!orderInfo)
                                        throw new Error("Order not found");
                                    commonTemplet = "<!DOCTYPE html>\n                <html lang=\"en\">\n                  <head>\n                    <meta charset=\"UTF-8\" />\n                    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n                    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n                    <title>invoiceThree</title>\n                    <link rel=\"stylesheet\" href=\"invoice.css\" />\n                    <style>\n                      * {\n                        padding: 0%;\n                        margin: 0%;\n                        box-sizing: border-box;\n                        font-family: Arial, Helvetica, sans-serif;\n                      }\n                \n                      .container {\n                        width: 100%;\n                        max-width: 860px;\n                        /* height: 100vh; */\n                        padding: 0.5rem;\n                        margin: auto;\n                      }\n                      table {\n                        border-collapse: collapse;\n                      }\n                      .table_one {\n                        height: 100%;\n                        width: 100%;\n                        background-color: white;\n                        padding-top: 1rem;\n                        padding-bottom: 1rem;\n                      }\n                \n                      .img_one {\n                        width: 100%;\n                        max-width: 11rem;\n                        padding: 1rem;\n                        /* margin-left: 2rem; */\n                      }\n                \n                      #td_2 {\n                        /* float: right; */\n                        /* margin-right: 2rem; */\n                        /* background-color: #e40581; */\n                        color: white;\n                        /* padding: 10px; */\n                      }\n                      .invoiceIdWarper {\n                        background-color: #e40581;\n                        width: 100%;\n                        padding: 1rem;\n                      }\n                      #td_3 {\n                        background: #000;\n                        width: 100%;\n                        height: 1px;\n                      }\n                \n                      #td_3 p {\n                        font-size: 1px;\n                      }\n                \n                      .td_5 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-top: 1rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      .td_4 {\n                        padding-left: 2rem;\n                        padding-top: 1rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_6 {\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                        color: #e40581;\n                      }\n                \n                      #td_7 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                        color: #e40581;\n                      }\n                \n                      #td_8 {\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_9 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_10 {\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_11 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_12 {\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_13 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_17 {\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                        padding-top: 0.5rem;\n                      }\n                \n                      #td_19 {\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td_18 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-bottom: 0.5rem;\n                        padding-top: 0.5rem;\n                      }\n                \n                      #td_14 {\n                        padding-left: 2rem;\n                        padding-bottom: 1rem;\n                        padding-top: 1rem;\n                      }\n                \n                      #td_15 {\n                        float: left;\n                        padding-left: 2rem;\n                        padding-bottom: 1rem;\n                        padding-top: 1rem;\n                      }\n                \n                      #td_16 {\n                        background-color: black;\n                        width: 100%;\n                        width: 1px;\n                        font-size: 1px;\n                      }\n                \n                      .table_two {\n                        height: 100%;\n                        width: 100%;\n                        background-color: white;\n                        padding-top: 1rem;\n                        padding-bottom: 1rem;\n                      }\n                \n                      .description {\n                        width: 40%;\n                      }\n                \n                      #td-1 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                        background: #e40581;\n                        color: white;\n                        text-align: start;\n                      }\n                \n                      #td-2 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                        background: #e40581;\n                        color: white;\n                        text-align: start;\n                      }\n                \n                      #td-3 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                        background: #e40581;\n                        color: white;\n                        text-align: start;\n                      }\n                \n                      #td-4 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                        background: #e40581;\n                        color: white;\n                        text-align: start;\n                      }\n                \n                      #td-5 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                        background: #e40581;\n                        color: white;\n                        text-align: start;\n                      }\n                      .img_two {\n                        height: 2.5rem;\n                        width: 2.5rem;\n                        object-fit: contain;\n                      }\n                \n                      #td-6 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-7 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-8 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-9 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-10 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-11 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-12 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-13 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-14 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                \n                      #td-15 {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                        padding-bottom: 0.5rem;\n                      }\n                      .border {\n                        background: #000;\n                        width: 100%;\n                        height: 1px;\n                        font-size: 1px;\n                      }\n                      .heading {\n                        background: #e40581;\n                      }\n                      .table_head {\n                        padding-left: 2rem;\n                        text-align: start;\n                        width:50%;\n                      }\n                      .table_three {\n                        width: 100%;\n                      }\n                      .table_body {\n                        padding-left: 2rem;\n                        padding-top: 0.5rem;\n                      }\n                      .table_span {\n                        padding: 5px;\n                        border: 1px solid black;\n                      }\n                      #sign {\n                        text-align: end;\n                        padding-top: 7rem;\n                        padding-bottom: 1rem;\n                        padding-right: 2rem;\n                      }\n                      .finalCalc{\n                        font-size: 1rem;\n                        margin: 1em 0em 2em 0em;\n                      }\n                    </style>\n                  </head>\n                \n                  <body>\n                    <div class=\"container\">\n                      <table class=\"table_one\">\n                        <tr class=\"tr_one\">\n                          <td id=\"td_1\" style=\"background-color:white\">\n                            <img\n                              src=\"".concat(process.env.LOGO_URL, "\"\n                              alt=\"\"\n                              class=\"img_one\"\n                            />\n                          </td>\n                          <td id=\"td_2\">\n                            <div class=\"invoiceIdWarper\">\n                              <h1>INVOICE</h1>\n                              <p>INVOICE NO: ").concat(((_a = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _a === void 0 ? void 0 : _a._id) || (orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo._id), "</p>\n                            </div>\n                          </td>\n                        </tr>\n                        <tr>\n                          <td colspan=\"2\" id=\"td_3\">\n                            <p>.</p>\n                          </td>\n                        </tr>\n                        <tr>\n                          <td class=\"td_4\" style=\"text-transform: uppercase\">\n                          </td>\n                          <td class=\"td_5\" style=\"text-transform: uppercase\">\n                            ").concat((orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) ? "<h3>Address :</h3>" : "", "\n                          </td>\n                        </tr>\n                        <tr>\n                          <td id=\"td_6\">\n                            \n                          </td>\n                          <td id=\"td_7\">\n                            ").concat(((_b = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _b === void 0 ? void 0 : _b.name)
                                        ? "<h3>".concat((_c = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _c === void 0 ? void 0 : _c.name, "</h3>")
                                        : "", "\n                            ").concat(((_d = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _d === void 0 ? void 0 : _d.street)
                                        ? "<b>".concat((_e = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _e === void 0 ? void 0 : _e.street, ", </b>")
                                        : "", "\n                            ").concat(((_f = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _f === void 0 ? void 0 : _f.landmark)
                                        ? "<b>".concat((_g = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _g === void 0 ? void 0 : _g.landmark, ", </b>")
                                        : "", "\n                            ").concat(((_h = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _h === void 0 ? void 0 : _h.city)
                                        ? "<b>".concat((_j = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _j === void 0 ? void 0 : _j.city, ", </b>")
                                        : "", "\n                            ").concat(((_k = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _k === void 0 ? void 0 : _k.state)
                                        ? "<b>".concat((_l = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _l === void 0 ? void 0 : _l.state, ", </b>")
                                        : "", "\n                            ").concat(((_m = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _m === void 0 ? void 0 : _m.country)
                                        ? "<b>".concat((_o = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _o === void 0 ? void 0 : _o.country, ", </b>")
                                        : "", "\n                            ").concat(((_p = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _p === void 0 ? void 0 : _p.email)
                                        ? "<b>".concat((_q = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _q === void 0 ? void 0 : _q.email, ", </b>")
                                        : "", "\n                            ").concat(((_r = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _r === void 0 ? void 0 : _r.country) &&
                                        ((_s = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _s === void 0 ? void 0 : _s.phoneNumber)
                                        ? "<b>+".concat(((_t = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _t === void 0 ? void 0 : _t.country,
                                            (_u = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.address) === null || _u === void 0 ? void 0 : _u.phoneNumber), "\n                            </b>")
                                        : "", "\n                          </td>\n                        </tr>\n                        <tr>\n                          <td colspan=\"2\" id=\"td_16\">.</td>\n                        </tr>\n                        <tr>\n                          <td id=\"td_17\">\n                            <p><b>Payment Method : </b>ONLINE</p>\n                          </td>\n                          <td id=\"td_18\">\n                            <p><b>Issue Date : </b>").concat((_w = new Date(((_v = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _v === void 0 ? void 0 : _v.createdAt) ||
                                        (orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.createdAt))) === null || _w === void 0 ? void 0 : _w.toLocaleString().split(",")[0], "</p>\n                          </td>\n                        </tr>\n                        <tr>\n                          <td id=\"td_19\">\n                            <p><b>Order Number : </b>").concat(orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo._id, "</p>\n                          </td>\n                        </tr>\n                      </table>\n                      <table class=\"table_two\">\n                        <tr class=\"heading\">\n                          <th id=\"td-1\">\n                            <b>Item</b>\n                          </th>\n                          <th class=\"description\" id=\"td-2\">Description</th>\n                          <th id=\"td-3\">Price</th>\n                          <th id=\"td-4\">Quantity</th>\n                          <th id=\"td-5\">Total</th>\n                        </tr>\n                        <!-- product item start -->\n                        ").concat((_y = (_x = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _x === void 0 ? void 0 : _x.orders) === null || _y === void 0 ? void 0 : _y.map(function (order) {
                                        var _a, _b, _c, _d, _e, _f;
                                        return order.product
                                            ? "<tr>\n                            <td id=\"td-6\">\n                              <img src=\"".concat((_b = (_a = order.product) === null || _a === void 0 ? void 0 : _a.displayImage) === null || _b === void 0 ? void 0 : _b.url, "\" alt=\"\" class=\"img_two\" />\n                            </td>\n                            <td class=\"description\" id=\"td-7\">\n                              <p>\n                                ").concat((_c = order === null || order === void 0 ? void 0 : order.product) === null || _c === void 0 ? void 0 : _c.shortDescription, "\n                              </p>\n                            </td>\n                            <td id=\"td-8\">").concat((_e = (_d = order.product) === null || _d === void 0 ? void 0 : _d.salePrice) === null || _e === void 0 ? void 0 : _e.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                            <td id=\"td-9\">").concat(order === null || order === void 0 ? void 0 : order.quantity, "</td>\n                            <td id=\"td-10\">").concat((_f = order === null || order === void 0 ? void 0 : order.price) === null || _f === void 0 ? void 0 : _f.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                          </tr>\n                          <tr>\n                            <td colspan=\"5\" class=\"border\">.</td>\n                          </tr>")
                                            : "";
                                    }).join(""), "\n                        <!-- product item end -->\n                        <!-- accessory item start -->\n                        ").concat((_z = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.accessory) === null || _z === void 0 ? void 0 : _z.map(function (product) {
                                        var _a, _b, _c;
                                        return "<tr>\n                            <td id=\"td-6\">\n                              <img src=\"".concat((_a = product === null || product === void 0 ? void 0 : product.displayImage) === null || _a === void 0 ? void 0 : _a.url, "\" alt=\"\" class=\"img_two\" />\n                            </td>\n                            <td class=\"description\" id=\"td-7\">\n                              <p>\n                                ").concat(product === null || product === void 0 ? void 0 : product.shortDescription, "\n                              </p>\n                            </td>\n                            <td id=\"td-8\">").concat((_b = product === null || product === void 0 ? void 0 : product.salePrice) === null || _b === void 0 ? void 0 : _b.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                            <td id=\"td-9\">1</td>\n                            <td id=\"td-10\">").concat((_c = product === null || product === void 0 ? void 0 : product.salePrice) === null || _c === void 0 ? void 0 : _c.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                          </tr>\n                          <tr>\n                            <td colspan=\"5\" class=\"border\">.</td>\n                          </tr>");
                                    }), "\n                        <!-- accessory item end -->\n                        <!-- service item start -->\n                        ").concat((_0 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.service) === null || _0 === void 0 ? void 0 : _0.map(function (order) {
                                        var _a, _b, _c, _d;
                                        return "<tr>\n                            <td id=\"td-6\">\n                              <img src=\"".concat((_a = order.service) === null || _a === void 0 ? void 0 : _a.image, "\" alt=\"\" class=\"img_two\" />\n                            </td>\n                            <td class=\"description\" id=\"td-7\">\n                              <p>\n                                ").concat((_b = order === null || order === void 0 ? void 0 : order.service) === null || _b === void 0 ? void 0 : _b.title, "\n                              </p>\n                            </td>\n                            <td id=\"td-8\">").concat((_c = order === null || order === void 0 ? void 0 : order.salePrice) === null || _c === void 0 ? void 0 : _c.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                            <td id=\"td-9\">1</td>\n                            <td id=\"td-10\">").concat((_d = order === null || order === void 0 ? void 0 : order.salePrice) === null || _d === void 0 ? void 0 : _d.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                          </tr>\n                          <tr>\n                            <td colspan=\"5\" class=\"border\">.</td>\n                          </tr>");
                                    }).join(""), "\n                        <!-- service item end -->\n                        <!-- extra service item start -->\n                        ").concat((_1 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.extraServices) === null || _1 === void 0 ? void 0 : _1.map(function (order) {
                                        var _a, _b, _c, _d;
                                        return "<tr>\n                            <td id=\"td-6\">\n                              <img src=\"".concat((_a = order.service) === null || _a === void 0 ? void 0 : _a.image, "\" alt=\"\" class=\"img_two\" />\n                            </td>\n                            <td class=\"description\" id=\"td-7\">\n                              <p>\n                                ").concat((_b = order === null || order === void 0 ? void 0 : order.service) === null || _b === void 0 ? void 0 : _b.title, "\n                              </p>\n                            </td>\n                            <td id=\"td-8\">").concat((_c = order === null || order === void 0 ? void 0 : order.salePrice) === null || _c === void 0 ? void 0 : _c.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                            <td id=\"td-9\">1</td>\n                            <td id=\"td-10\">").concat((_d = order === null || order === void 0 ? void 0 : order.salePrice) === null || _d === void 0 ? void 0 : _d.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                          </tr>\n                          <tr>\n                            <td colspan=\"5\" class=\"border\">.</td>\n                          </tr>");
                                    }).join(""), "\n                        <!-- extra service item end -->\n                        <!-- evaluation service item start -->\n                        ").concat((_2 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.evaluatedValues) === null || _2 === void 0 ? void 0 : _2.map(function (evaluated) {
                                        var _a, _b, _c, _d;
                                        return "<tr>\n                            <td id=\"td-6\">\n                              <img src=\"".concat((_a = evaluated === null || evaluated === void 0 ? void 0 : evaluated.evaluation) === null || _a === void 0 ? void 0 : _a.image, "\" alt=\"\" class=\"img_two\" />\n                            </td>\n                            <td class=\"description\" id=\"td-7\">\n                              <p>\n                                ").concat((_b = evaluated === null || evaluated === void 0 ? void 0 : evaluated.evaluation) === null || _b === void 0 ? void 0 : _b.title, "\n                              </p>\n                            </td>\n                            <td id=\"td-8\">-").concat((_c = evaluated === null || evaluated === void 0 ? void 0 : evaluated.price) === null || _c === void 0 ? void 0 : _c.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                            <td id=\"td-9\">1</td>\n                            <td id=\"td-10\">-").concat((_d = evaluated === null || evaluated === void 0 ? void 0 : evaluated.price) === null || _d === void 0 ? void 0 : _d.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</td>\n                          </tr>\n                          <tr>\n                            <td colspan=\"5\" class=\"border\">.</td>\n                          </tr>");
                                    }).join(""), "\n                        <!-- evaluation service item end -->\n                      </table>\n                      <table class=\"table_three finalCalc\">\n                        <tr>\n                          <th class=\"table_head headId\">\n                          </th>\n                          <th class=\"table_head\">\n                            <h4>SubTotal</h4>\n                            ").concat(((_3 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _3 === void 0 ? void 0 : _3.tax) ||
                                        ((_4 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.extraBilling) === null || _4 === void 0 ? void 0 : _4.tax)
                                        ? "<p style=\"font-size: 0.8rem;\">(Tax ".concat((_7 = ((((_5 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _5 === void 0 ? void 0 : _5.tax) || 0) +
                                            (((_6 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.extraBilling) === null || _6 === void 0 ? void 0 : _6.tax) || 0))) === null || _7 === void 0 ? void 0 : _7.toLocaleString("en-IN", {
                                            style: "currency",
                                            currency: "GBP",
                                        }), "/-)</p>")
                                        : "", "\n                          </th>\n                          <th class=\"table_head\">\n                            <h4>").concat((_10 = ((((_8 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _8 === void 0 ? void 0 : _8.total) || 0) +
                                        (((_9 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.extraBilling) === null || _9 === void 0 ? void 0 : _9.total) || 0) +
                                        ((orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.evaluatedPrice) || 0))) === null || _10 === void 0 ? void 0 : _10.toLocaleString("en-IN", {
                                        style: "currency",
                                        currency: "GBP",
                                    }), "/-</h4>\n                          </th>\n                        </tr>\n                        \n                        <tr>\n                        ").concat(((_12 = (_11 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _11 === void 0 ? void 0 : _11.couponDiscount) === null || _12 === void 0 ? void 0 : _12.benefitAmount)
                                        ? "<th class=\"table_head headId\">\n                          </th>\n                          <td class=\"table_body\">\n                            <h4>Coupon Discount</h4>\n                          </td>\n                          <td class=\"table_body\">\n                            <h4>".concat((_15 = (_14 = (_13 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _13 === void 0 ? void 0 : _13.couponDiscount) === null || _14 === void 0 ? void 0 : _14.benefitAmount) === null || _15 === void 0 ? void 0 : _15.toLocaleString("en-IN", { style: "currency", currency: "GBP" }), "/-</h4>\n                          </td>\n                        </tr>")
                                        : "", "\n                        <tr>\n                        <th class=\"table_head headId\">\n                        </th>\n                          <td class=\"table_body\">\n                            <h4>Total</h4>\n                          </td>\n                          <td class=\"table_body\">\n                            <h4>").concat((_18 = ((((_16 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.billing) === null || _16 === void 0 ? void 0 : _16.total) || 0) +
                                        (((_17 = orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.extraBilling) === null || _17 === void 0 ? void 0 : _17.total) || 0) +
                                        ((orderInfo === null || orderInfo === void 0 ? void 0 : orderInfo.evaluatedPrice) || 0))) === null || _18 === void 0 ? void 0 : _18.toLocaleString("en-IN", {
                                        style: "currency",
                                        currency: "GBP",
                                    }), "/-</h4>\n                          </td>\n                        </tr>\n                      </table>\n                      <table style=\"width: 100%; text-align: center\">\n                        <tr>\n                          <td style=\"width: 30%\">\n                            <hr style=\"background-color: black\" />\n                          </td>\n                          <td style=\"border: 1px solid black; padding: 5px\">\n                            Thank You\n                          </td>\n                          <td style=\"width: 30%\">\n                            <hr style=\"background-color: black\" />\n                          </td>\n                        </tr>\n                      </table>\n                    </div>\n                  </body>\n                </html>\n                ");
                                    resolve({
                                        invoiceHTML: commonTemplet,
                                        orderData: orderInfo,
                                    });
                                    return [3 /*break*/, 3];
                                case 2:
                                    error_1 = _19.sent();
                                    reject(error_1);
                                    return [3 /*break*/, 3];
                                case 3: return [2 /*return*/];
                            }
                        });
                    }); })];
            });
        });
    };
    return InvoiceLogic;
}());
exports.default = InvoiceLogic;
